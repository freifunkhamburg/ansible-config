{% if updates_tls_crt is defined %}
server {
    server_name updates.hamburg.freifunk.net;
    listen 443 ssl;
    listen [::]:443 ssl;
    ssl_certificate {{ updates_tls_crt }};
    ssl_certificate_key {{ updates_tls_key }};

    include snippets/autoindex.conf;
    include snippets/header-hsts.conf;
    include snippets/header-security.conf;
    include snippets/no-unsafe-files.conf;

    root {{ updates_root }};
}

{% endif %}
# Kein HTTPS Redirect wg. Paketinstallation auf Routern
server {
    server_name updates.hamburg.freifunk.net;
    listen 80;
    listen [::]:80;

    include snippets/autoindex.conf;
    include snippets/header-security.conf;
    include snippets/no-unsafe-files.conf;

    root {{ updates_root }};

{% if updates_letsencrypt == 'local' %}
    include snippets/location-acme.conf;
{% elif updates_letsencrypt == 'srv01' %}
    include snippets/location-acme-srv01.conf;
{% endif %}
}

server {
    server_name *.updates.services.ffhh;
    listen 80;
    listen [::]:80;

    include snippets/autoindex.conf;
    include snippets/header-security.conf;
    include snippets/no-unsafe-files.conf;

    root {{ updates_root }};
}
